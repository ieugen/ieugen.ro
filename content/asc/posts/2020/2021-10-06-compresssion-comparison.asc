{:title "Compression comparison"
 :layout :post
 :date   "2021-10-06"
 :tags  ["cryogen" "asciidoc"]
 :toc false
 :draft? true
 :lang "en"
}


--
uname -a
Linux daos-495 5.10.0-8-amd64 #1 SMP Debian 5.10.46-5 (2021-09-23) x86_64 GNU/Linux

uname -a
Linux admin 5.11.0-1019-aws #20~20.04.1-Ubuntu SMP Tue Sep 21 10:40:39 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux
--


triplestore compression time and archive size: zstd  seems to be the best (see Real time)

ubuntu@dev2:~$ time tar c --zstd -f triplestore2.tar.zstd /drevidence/docsearch/rel-triple-store/triplestore
real	3m9.973s
user	2m59.136s
sys	1m5.424s

# zstd with all cores (-T0)
time tar c -I"zstd -T0" -f triplestore.tar.zstd /drevidence/docsearch/rel-triple-store/triplestore

real	2m16.109s
user	3m16.934s
sys	1m3.722s

ubuntu@dev2:~$ time tar cz -f triplestore.tar.gz /drevidence/docsearch/rel-triple-store/triplestore

real	25m39.886s
user	25m21.624s
sys	1m3.849s
ubuntu@dev2:~$ time tar c -Ipigz -f triplestore2.tar.gz /drevidence/docsearch/rel-triple-store/triplestore

real	4m35.810s
user	33m28.872s
sys	1m33.353s

Sizes:

ls -lh
total 88G
-rw-rw-r-- 1 ubuntu ubuntu  22G Oct  5 08:33 relstore.tar.zstd
-rw-rw-r-- 1 ubuntu ubuntu  32G Oct  5 09:39 relstore2.tar.gz
-rw-rw-r-- 1 ubuntu ubuntu 9.2G Oct  5 09:00 triplestore.tar.gz
-rw-rw-r-- 1 ubuntu ubuntu 8.4G Oct  5 08:27 triplestore.tar.zstd
-rw-rw-r-- 1 ubuntu ubuntu 9.2G Oct  5 09:12 triplestore2.tar.gz
-rw-rw-r-- 1 ubuntu ubuntu 8.4G Oct  5 09:16 triplestore2.tar.zstd

also relstore:

ubuntu@dev2:~$ time tar c -I"zstd -T0" -f relstore.tar.zstd /drevidence/docsearch/rel-triple-store/relstore
real	5m23.506s
user	6m18.915s
sys	2m1.143s

time tar c -Ipigz -f relstore2.tar.gz /drevidence/docsearch/rel-triple-store/relstore

real	9m55.759s
user	74m16.732s
sys	2m56.449s



Unpack aws EBS:

time tar -xf triplestore.tar.zst -C  triple

real	5m46.634s
user	0m56.960s
sys	1m17.265s

time tar -xf relstore.tar.zst -C  relst

real	12m9.385s
user	1m1.704s
sys	2m19.575s

# local nvme
time sudo tar -xf ../../../data/relstore.tar.zst -C docker-data/relstore

real	3m34,125s
user	1m15,455s
sys	2m47,539s

time sudo tar -xf ../../../data/triplestore.tar.zst -C docker-data/triplestore
real	2m31,923s
user	1m12,730s
sys	1m39,374s


